def Pattern := List (Int × Int)

def shift (delta : Int × Int)
          (pat : Pattern)
          : Pattern :=
  pat.map (λ (x, y) => (x + delta.fst, y + delta.snd))

def glider : Pattern :=
  [ (0, 1)
  , (1, 2)
  , (2, 0)
  , (2, 1)
  , (2, 2)
  ]

def blinker : Pattern :=
  [ (1, 0)
  , (1, 1)
  , (1, 2)
  ]

def toad : Pattern :=
  [ (1, 1), (2, 1), (3, 1)
  , (0, 2), (1, 2), (2, 2)
  ]

def beacon : Pattern :=
  [ (0, 0), (1, 0)
  , (0, 1), (1, 1)
  , (2, 2), (3, 2)
  , (2, 3), (3, 3)
  ]

def diehard : Pattern :=
  [ (6, 0)
  , (0, 1), (1, 1)
  , (1, 2), (5, 2), (6, 2), (7, 2)
  ]

def acorn : Pattern := shift (8, 8)
  [ (1, 0)
  , (3, 1)
  , (0, 2), (1, 2), (4, 2), (5, 2), (6, 2)
  ]

def rPentomino : Pattern := shift (10, 10)
  [ (1, 0), (2, 0)
  , (0, 1), (1, 1)
  , (1, 2)
  ]

def pulsar : Pattern :=
  [ (2,0), (3,0), (4,0), (8,0), (9,0), (10,0)
  , (0,2), (5,2), (7,2), (12,2)
  , (0,3), (5,3), (7,3), (12,3)
  , (0,4), (5,4), (7,4), (12,4)
  , (2,5), (3,5), (4,5), (8,5), (9,5), (10,5)
  , (2,7), (3,7), (4,7), (8,7), (9,7), (10,7)
  , (0,8), (5,8), (7,8), (12,8)
  , (0,9), (5,9), (7,9), (12,9)
  , (0,10), (5,10), (7,10), (12,10)
  , (2,12), (3,12), (4,12), (8,12), (9,12), (10,12)
  ]

def gosperGliderGun : Pattern := shift (5, 5)
  [ (1,5), (1,6), (2,5), (2,6)
  , (11,5), (11,6), (11,7)
  , (12,4), (12,8)
  , (13,3), (13,9)
  , (14,3), (14,9)
  , (15,6)
  , (16,4), (16,8)
  , (17,5), (17,6), (17,7)
  , (18,6)
  , (21,3), (21,4), (21,5)
  , (22,3), (22,4), (22,5)
  , (23,2), (23,6)
  , (25,1), (25,2), (25,6), (25,7)
  , (35,3), (35,4)
  , (36,3), (36,4)
  ]

def pentadecathlonSeed : Pattern := shift (10, 10)
  [ (0, 0), (1, 0), (2, 0), (3, 0), (4, 0)
  , (5, 0), (6, 0), (7, 0), (8, 0), (9, 0)
  ]

def queenBeeShuttle : Pattern := shift (10, 10)
  [ (9, 0), (10, 0)
  , (9, 1), (11, 1)
  , (4, 2), (5, 2), (12, 2), (20, 2), (21, 2)
  , (0, 3), (1, 3), (3, 3), (6, 3), (9, 3), (12, 3), (20, 3), (21, 3)
  , (0, 4), (1, 4), (4, 4), (5, 4), (12, 4)
  , (9, 5), (11, 5)
  , (9, 6), (10, 6)
  ]

def allPatterns : List Pattern :=
  [ glider
  , blinker
  , toad
  , beacon
  , diehard
  , acorn
  , rPentomino
  , pulsar
  , gosperGliderGun
  , pentadecathlonSeed
  , queenBeeShuttle
  ]
